{% extends "index.html" %}

{% block content %}
<h1>ğŸ® Ğ˜Ğ³Ñ€Ñ‹</h1>

<div class="balance">
    Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: {{ balance }} STAR
</div>

<nav style="margin: 20px 0;">
    <a href="/games" class="btn" style="background: #ff9800;">ğŸ® Ğ˜Ğ³Ñ€Ñ‹</a>
    <a href="/profile" class="btn" style="background: #2196f3;">ğŸ“Š ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</a>
    {% if user_id|int == 7973988177 %}
    <a href="/admin" class="btn" style="background: #f44336;">ğŸ‘‘ ĞĞ´Ğ¼Ğ¸Ğ½</a>
    {% endif %}
    <a href="/logout" class="btn" style="background: #9e9e9e;">ğŸšª Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</a>
</nav>

<div class="game">
    <h3>ğŸª™ Monkey Flip</h3>
    <p>ĞŸĞ¾Ğ´Ğ±Ñ€Ğ¾ÑÑŒ Ğ±Ğ°Ğ½Ğ°Ğ½ Ğ¸ ÑƒĞ³Ğ°Ğ´Ğ°Ğ¹ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñƒ!</p>
    <div id="flip-game">
        <input type="number" id="flip-bet" placeholder="Ğ¡Ñ‚Ğ°Ğ²ĞºĞ° (STAR)" min="1" max="{{ balance }}" style="width: 100%; padding: 10px; margin: 5px 0;">
        <button onclick="playFlip('heads')" class="btn" style="background: #4caf50;">ğŸŒ Banana</button>
        <button onclick="playFlip('tails')" class="btn" style="background: #ff5722;">ğŸµ Monkey</button>
    </div>
</div>

<div class="game">
    <h3>ğŸš€ Banana Crash</h3>
    <p>Ğ—Ğ°Ğ±ĞµÑ€Ğ¸ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ Ğ´Ğ¾ ĞºÑ€Ğ°ÑˆĞ°!</p>
    <div id="crash-game">
        <input type="number" id="crash-bet" placeholder="Ğ¡Ñ‚Ğ°Ğ²ĞºĞ° (STAR)" min="1" max="{{ balance }}" style="width: 100%; padding: 10px; margin: 5px 0;">
        <button onclick="playCrash()" class="btn" style="background: #9c27b0;">ğŸ® Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
    </div>
</div>

<div class="game">
    <h3>ğŸ° Ğ¡Ğ»Ğ¾Ñ‚-Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°</h3>
    <p>ĞšÑ€ÑƒÑ‚Ğ¸ Ğ±Ğ°Ñ€Ğ°Ğ±Ğ°Ğ½Ñ‹ Ğ¸ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°Ğ¹!</p>
    <div id="slot-game">
        <input type="number" id="slot-bet" placeholder="Ğ¡Ñ‚Ğ°Ğ²ĞºĞ° (STAR)" min="1" max="{{ balance }}" style="width: 100%; padding: 10px; margin: 5px 0;">
        <button onclick="playSlot()" class="btn" style="background: #009688;">ğŸ° ĞšÑ€ÑƒÑ‚Ğ¸Ñ‚ÑŒ</button>
    </div>
</div>

<script>
async function playGame(game, bet, data = {}) {
    const response = await fetch('/api/play', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({game, bet, ...data})
    });
    
    const result = await response.json();
    
    if (result.error) {
        alert(result.error);
        return;
    }
    
    if (result.win) {
        alert(`ğŸ‰ Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ ${result.amount.toFixed(2)} STAR! ĞœĞ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ: x${result.multiplier.toFixed(2)}`);
    } else {
        alert(`ğŸ˜¢ Ğ’Ñ‹ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ ${bet} STAR`);
    }
    
    location.reload();
}

function playFlip(choice) {
    const bet = parseFloat(document.getElementById('flip-bet').value);
    if (!bet || bet <= 0) {
        alert('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑ‚Ğ°Ğ²ĞºÑƒ');
        return;
    }
    playGame('flip', bet, {choice});
}

function playCrash() {
    const bet = parseFloat(document.getElementById('crash-bet').value);
    if (!bet || bet <= 0) {
        alert('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑ‚Ğ°Ğ²ĞºÑƒ');
        return;
    }
    playGame('crash', bet);
}

function playSlot() {
    const bet = parseFloat(document.getElementById('slot-bet').value);
    if (!bet || bet <= 0) {
        alert('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑ‚Ğ°Ğ²ĞºÑƒ');
        return;
    }
    playGame('slot', bet);
}
</script>
{% endblock %}
